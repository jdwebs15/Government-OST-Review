<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Civic Influence: Actions & Government Levels (CS 1/17/19) ‚Äî Government OST Review</title>

  <!-- Uses your shared hub stylesheet if present -->
  <link rel="stylesheet" href="../styles.css" />

  <style>
    :root{
      --bg:#0b1220;
      --panel:#121a2f;
      --card:#111a2e;
      --text:#e7eefc;
      --muted:#a8b4cf;
      --line:rgba(255,255,255,.12);
      --shadow:0 18px 55px rgba(0,0,0,.40);
      --radius:18px;
      --good:#2bd576;
      --bad:#ff5c7a;
      --warn:#ffd166;
      --accent:#7aa2ff;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,#0b1220,#070b14);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      min-height:100vh;
    }
    .wrap{ width:min(980px, 92vw); margin: 22px auto 40px; }
    .topbar{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:18px 18px 14px;
      box-shadow:var(--shadow);
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between;
    }
    .kicker{letter-spacing:.14em; font-size:12px; color:var(--muted); font-weight:700}
    h1{margin:6px 0 6px; font-size:24px}
    .sub{margin:0; color:var(--muted); line-height:1.35}
    .pillrow{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end}
    .pill{
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
    }

    .grid{display:grid; grid-template-columns: 1.1fr .9fr; gap:14px; margin-top:14px;}
    @media (max-width: 900px){ .grid{grid-template-columns:1fr;} }

    .panel{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
    }
    .row{display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap}
    .label{color:var(--muted); font-size:12px; letter-spacing:.08em; font-weight:800}
    .statline{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .stat{
      background:rgba(255,255,255,.02);
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      min-width: 140px;
    }
    .stat .big{font-size:16px; font-weight:800}
    .stat .small{font-size:12px; color:var(--muted); margin-top:2px}

    .qtitle{margin:10px 0 6px; font-size:18px}
    .qtext{color:var(--text); line-height:1.4; margin:0 0 12px}

    .opts{display:grid; gap:10px; margin-top:10px}
    .optbtn{
      text-align:left;
      width:100%;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      padding:12px 12px;
      color:var(--text);
      cursor:pointer;
      transition: transform .04s ease, border-color .15s ease, background .15s ease;
    }
    .optbtn:hover{border-color:rgba(122,162,255,.45)}
    .optbtn:active{transform: scale(.995)}
    .optbtn[disabled]{opacity:.65; cursor:not-allowed}
    .optbtn .ltr{
      font-family:var(--mono);
      font-weight:900;
      margin-right:8px;
      color:var(--accent);
    }

    .msg{
      border-radius:14px;
      border:1px solid var(--line);
      padding:12px;
      margin-top:12px;
      display:none;
    }
    .msg.good{display:block; border-color: rgba(43,213,118,.35); background: rgba(43,213,118,.08);}
    .msg.bad{display:block; border-color: rgba(255,92,122,.35); background: rgba(255,92,122,.08);}
    .msg.warn{display:block; border-color: rgba(255,209,102,.35); background: rgba(255,209,102,.08);}
    .msg .t{font-weight:800; margin-bottom:4px}
    .msg .b{color:var(--muted); line-height:1.35}

    .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}
    .btn{
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--text);
      padding:10px 12px;
      cursor:pointer;
      font-weight:800;
    }
    .btn:hover{border-color:rgba(122,162,255,.45)}
    .btn.primary{
      border-color: rgba(122,162,255,.45);
      background: rgba(122,162,255,.10);
    }
    .btn[disabled]{opacity:.6; cursor:not-allowed}

    .field{display:grid; gap:6px; margin-top:10px;}
    input[type="text"]{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      color:var(--text);
      outline:none;
    }
    input[type="text"]:focus{border-color:rgba(122,162,255,.55)}

    /* Grid questions */
    .gridq{margin-top:12px; border:1px solid var(--line); border-radius:14px; overflow:hidden}
    .gridq .hdr{
      display:grid;
      gap:0;
      background:rgba(255,255,255,.03);
      border-bottom:1px solid var(--line);
    }
    .gridq .hdr div{
      padding:10px 10px;
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      letter-spacing:.06em;
    }
    .gridq .r{
      display:grid;
      border-bottom:1px solid var(--line);
    }
    .gridq .r:last-child{border-bottom:none}
    .gridq .cell{padding:10px 10px}
    .gridq .src{color:var(--text); line-height:1.35}
    .gridq label{display:flex; align-items:center; gap:8px; color:var(--muted); font-size:13px}
    .gridq input{transform: translateY(1px);}

    /* Error box */
    .errbox{
      display:none;
      margin-top:14px;
      border:1px solid rgba(255,92,122,.45);
      background: rgba(255,92,122,.10);
      border-radius:14px;
      padding:12px;
    }
    .errbox .t{font-weight:900}
    .errbox pre{margin:8px 0 0; white-space:pre-wrap; color:var(--text); font-family:var(--mono); font-size:12px}

    .muted{color:var(--muted)}
    .mono{font-family:var(--mono)}

    .ticket{
      margin-top:12px;
      border:1px solid rgba(43,213,118,.35);
      background: rgba(43,213,118,.07);
      border-radius:14px;
      padding:12px;
    }
    .ticket .code{
      font-family:var(--mono);
      font-weight:900;
      letter-spacing:.06em;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.02);
      margin-top:8px;
      word-break:break-word;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div>
        <div class="kicker">GOVERNMENT OST REVIEW</div>
        <h1>Civic Influence: Actions &amp; Government Levels (CS 1/17/19)</h1>
        <p class="sub">
          Released items (verbatim). Mastery requires <b>100% accuracy</b>. Wrong answers trigger a hint and retry; accuracy reflects the miss.
        </p>
      </div>
      <div class="pillrow">
        <div class="pill">Mastery (100%) ‚úÖ</div>
        <div class="pill">Name + timestamps ‚úÖ</div>
        <div class="pill">Submission ticket ‚úÖ</div>
      </div>
    </div>

    <div id="errbox" class="errbox" role="alert">
      <div class="t">On-page error box</div>
      <div class="muted">Copy the details below if anything ‚Äúwhite screens.‚Äù</div>
      <pre id="errtext"></pre>
    </div>

    <div class="grid">
      <!-- MAIN -->
      <section class="panel">
        <div class="row">
          <div class="label">QUESTION</div>
          <div class="statline">
            <div class="stat">
              <div class="big" id="qpos">‚Äî</div>
              <div class="small">Progress</div>
            </div>
            <div class="stat">
              <div class="big" id="acc">‚Äî</div>
              <div class="small">Accuracy</div>
            </div>
            <div class="stat">
              <div class="big" id="runtime">‚Äî</div>
              <div class="small">Runtime</div>
            </div>
          </div>
        </div>

        <h2 class="qtitle" id="qtitle">Enter your name to begin</h2>
        <p class="qtext" id="qtext">Your teacher requires a submission ticket at the end (no cropping). Use your real name.</p>

        <div id="nameBox" class="field">
          <label class="muted" for="studentName"><b>Student Name</b></label>
          <input id="studentName" type="text" placeholder="e.g., Jordan Smith" autocomplete="name" />
          <div class="actions">
            <button class="btn primary" id="btnStart">Start</button>
            <button class="btn" id="btnResetAll" title="Clears saved progress for this game only">Reset Game</button>
          </div>
          <div class="muted" style="margin-top:6px;font-size:12px;">
            Note: progress is saved in this browser (localStorage) until you finish or reset.
          </div>
        </div>

        <div id="questionBox" style="display:none;">
          <div id="mcqBox" style="display:none;">
            <div class="opts" id="opts"></div>
          </div>

          <div id="gridBox" style="display:none;">
            <p class="qtext" id="gridPrompt"></p>
            <div class="gridq" id="gridQ"></div>
            <div class="actions">
              <button class="btn primary" id="btnSubmitGrid">Submit</button>
            </div>
          </div>

          <div id="feedback" class="msg" aria-live="polite">
            <div class="t" id="fbTitle"></div>
            <div class="b" id="fbBody"></div>
          </div>

          <div class="actions">
            <button class="btn" id="btnHint" disabled>Hint</button>
            <button class="btn primary" id="btnNext" disabled>Next</button>
          </div>
        </div>

        <div id="finishBox" style="display:none;">
          <h2 class="qtitle">Finish</h2>
          <p class="qtext">
            If you have <b>100% accuracy</b>, you‚Äôll receive a submission ticket. If not, you must reset and replay for mastery.
          </p>

          <div id="finishMsg" class="msg warn" style="display:block;">
            <div class="t" id="finishTitle">Checking mastery‚Ä¶</div>
            <div class="b" id="finishBody">‚Äî</div>
          </div>

          <div id="ticket" class="ticket" style="display:none;">
            <div><b>Submission Ticket</b> (screenshot this)</div>
            <div class="muted" style="margin-top:6px;line-height:1.35">
              Name: <span id="tName"></span><br/>
              Date: <span id="tDate"></span><br/>
              Start: <span id="tStart"></span><br/>
              End: <span id="tEnd"></span><br/>
              Runtime: <span id="tRun"></span><br/>
              Accuracy: <span id="tAcc"></span>
            </div>
            <div class="code" id="tCode">‚Äî</div>
            <div class="actions" style="margin-top:10px;">
              <button class="btn primary" id="btnCopy">Copy Ticket Code</button>
              <button class="btn" id="btnReset">Play Again</button>
            </div>
          </div>

          <div class="actions" style="margin-top:10px;">
            <button class="btn" id="btnBackHome" onclick="location.href='../index.html'">Back to Hub</button>
          </div>
        </div>
      </section>

      <!-- SIDE INFO -->
      <aside class="panel">
        <div class="label">RULES</div>
        <ul class="muted" style="margin:10px 0 0; line-height:1.45;">
          <li><b>Mastery</b> = finish all items with <b>0 misses</b> (100% accuracy).</li>
          <li>Wrong answer ‚Üí hint appears ‚Üí you retry until correct, but accuracy keeps the miss.</li>
          <li>Ticket at end includes name + timestamps + runtime.</li>
        </ul>

        <hr style="border:none;border-top:1px solid var(--line); margin:14px 0;">

        <div class="label">WHAT THIS GAME PRACTICES</div>
        <p class="muted" style="margin:10px 0 0; line-height:1.45;">
          Choosing effective civic actions, matching actions to the correct level of government, and using public meetings/petitions/letters to influence policy.
        </p>

        <hr style="border:none;border-top:1px solid var(--line); margin:14px 0;">

        <div class="label">SAVED PROGRESS</div>
        <p class="muted" style="margin:10px 0 0; line-height:1.45;">
          Progress saves automatically for this game in this browser. Reset removes saved data for this game only.
        </p>
      </aside>
    </div>
  </div>

<script>
(() => {
  // ---------- Hardened shell + on-page error box ----------
  const errbox = document.getElementById('errbox');
  const errtext = document.getElementById('errtext');
  window.addEventListener('error', (e) => {
    errbox.style.display = 'block';
    errtext.textContent = `Error: ${e.message}\nSource: ${e.filename}:${e.lineno}:${e.colno}`;
  });
  window.addEventListener('unhandledrejection', (e) => {
    errbox.style.display = 'block';
    errtext.textContent = `Unhandled Promise Rejection:\n${(e.reason && e.reason.stack) ? e.reason.stack : e.reason}`;
  });

  // ---------- Utilities ----------
  const pad2 = n => String(n).padStart(2,'0');
  const fmtTime = (d) => {
    const hr = d.getHours();
    const ampm = hr >= 12 ? 'PM' : 'AM';
    const h12 = hr % 12 || 12;
    return `${h12}:${pad2(d.getMinutes())}:${pad2(d.getSeconds())} ${ampm}`;
  };
  const fmtDate = (d) => `${d.getMonth()+1}/${d.getDate()}/${d.getFullYear()}`;
  const msToHMS = (ms) => {
    const s = Math.max(0, Math.floor(ms/1000));
    const hh = Math.floor(s/3600);
    const mm = Math.floor((s%3600)/60);
    const ss = s%60;
    return `${hh}:${pad2(mm)}:${pad2(ss)}`;
  };
  const now = () => new Date();

  const hash32 = (str) => {
    let h = 2166136261 >>> 0;
    for (let i=0;i<str.length;i++){
      h ^= str.charCodeAt(i);
      h = Math.imul(h, 16777619);
    }
    return h >>> 0;
  };
  const base36 = (n) => n.toString(36).toUpperCase();

  // ---------- State ----------
  const STORAGE_KEY = 'GOV_OST_CIVIC_ACTIONS_V1';
  let state = {
    name: '',
    startedAtISO: '',
    startedAtMS: 0,
    idx: 0,
    attempts: 0,
    correct: 0,
    missed: 0
  };

  // ---------- Released items (verbatim) ----------
 const QUESTIONS = [
  // =========================
  // RELEASED (verbatim)
  // =========================
  {
    id: 'Q9_GA_TEACHERS',
    type: 'mcq',
    title: 'Civic Influence ‚Äî State Legislature (Released)',
    prompt:
`The Ohio General Assembly is considering a bill that would reduce the amount of tax revenue allocated to local school systems. A group of teachers is opposed to the passage of this bill. What would be the MOST effective action that the teachers' group could take to influence the General Assembly's vote on this bill?`,
    options: [
      'Filing an appeal with the State Supreme Court',
      'Starting a letter writing campaign to state legislators',
      'Offering comments during local city council meetings',
      'Holding public demonstrations in front of the White House'
    ],
    answerIndex: 1,
    hint: 'State legislature ‚Üí contact state legislators directly.',
    explain: 'Correct: a letter writing campaign to state legislators directly targets the decision-makers.'
  },
  {
    id: 'Q10_JEFF_LOCAL_STATE',
    type: 'grid_single_per_row',
    title: 'Government Level ‚Äî Local vs State (Released)',
    prompt:
`Jeff wants to make sure that emergency services are adequately supported in his town and across the state of Ohio. Select the boxes to identify whether Jeff would take the action at the local or state level.`,
    grid: {
      columns: ['Local', 'State'],
      rows: [
        { source: 'Serve in a volunteer fire department', correctCol: 0 },
        { source: 'Organize a charity event to raise money for his town‚Äôs police force', correctCol: 0 },
        { source: 'Meet with the town‚Äôs mayor to discuss the emergency services budget', correctCol: 0 },
        { source: 'Run for the General Assembly on a platform of improved emergency services', correctCol: 1 },
        { source: 'Sign a petition to bring the issue of emergency services to the governor‚Äôs attention', correctCol: 1 }
      ]
    },
    hint: 'Mayor/town services = local. General Assembly/Governor = state.',
    explain: 'Correct: local actions involve town officials/services; state actions involve the governor/General Assembly.'
  },
  {
    id: 'Q13_MATCH_SITUATION_STEP',
    type: 'grid_single_per_row',
    title: 'Match: Situation ‚Üí Appropriate Civic Step (Released)',
    prompt:
`Several situations are described in which citizens are dissatisfied with public policy. Select the boxes to match the situation with the appropriate step for a citizen to take.`,
    grid: {
      columns: [
        'Write letters to the governor and members of the General Assembly',
        'Campaign for a challenger running against a current U.S. senator',
        'Sign a petition that will be sent to the president',
        'Speak at a city council meeting'
      ],
      rows: [
        { source: 'A citizen disagrees with an executive order that impacts national foreign policy', correctCol: 2 },
        { source: 'A citizen believes that a new playground should be built in a neighborhood park', correctCol: 3 },
        { source: 'A citizen fears the environmental impact of a state road construction project', correctCol: 0 },
        { source: 'A citizen believes that her views are being poorly represented at the congressional level', correctCol: 1 }
      ]
    },
    hint: 'Match by level: president/national, city/local, governor/GA state, Congress/campaign.',
    explain: 'Correct: each scenario aligns with the official/government level most connected to the policy.'
  },
  {
    id: 'Q23_PARK_MAINTENANCE',
    type: 'mcq',
    title: 'Community Action ‚Äî Local Problem (Released)',
    prompt:
`A town council faces budget cuts and can no longer afford to pay for landscaping in town parks. How can a citizen work within his or her own communities or the local government address this problem?`,
    options: [
      'By emailing Ohio congressional delegation to inform them of the issue',
      'By organizing a group of residents to volunteer for weekly park maintenance',
      'By requesting that the governor supply the town with state funds for park maintenance',
      'By running for a seat in the general assembly with a promise to increase funding for local parks'
    ],
    answerIndex: 1,
    hint: 'Local problem ‚Üí local volunteer/community action.',
    explain: 'Correct: organizing residents to volunteer is the most direct community-level solution.'
  },
  {
    id: 'Q49_PUBLIC_COMMENT_ORDINANCE',
    type: 'mcq',
    title: 'Public Meeting ‚Äî Influence Local Policy (Released)',
    prompt:
`Marla‚Äôs local government is considering an ordinance that would require all residents to separate their trash into two containers before putting it out for collection. Marla thinks this is a good idea. Which action could Marla take to most effectively encourage the passage of this ordinance?`,
    options: [
      'Writing to her United States senators to express her opinion and urge them to vote',
      'Attending a public comment session of the city council and giving reasons for her support',
      'Volunteering to work on the campaign of a candidate for governor who supports recycling',
      'Organizing people in her community to express their support to the Ohio General Assembly'
    ],
    answerIndex: 1,
    hint: 'Local ordinance ‚Üí city council public comment.',
    explain: 'Correct: city council public comment directly targets the decision-makers.'
  },
  {
    id: 'GOV17_NEW2025',
    type: 'mcq',
    title: 'GOV.17 ‚Äî Civic Participation (Released)',
    prompt:
`How can citizens directly help local government authorities?`,
    options: [
      'paying federal taxes',
      'enlisting in National Guard',
      'joining neighborhood civic organizations',
      'delivering a petition to state legislature'
    ],
    answerIndex: 2,
    hint: 'Local authorities are helped most by local community organizations.',
    explain: 'Correct: joining neighborhood civic organizations directly supports local government efforts.'
  },
  {
    id: 'GOV19_NEW2025',
    type: 'mcq',
    title: 'GOV.19 ‚Äî Public Policy Influence (Released)',
    prompt:
`Which action would effectively influence officials?`,
    options: [
      'file brief at Ohio Supreme Court',
      'testify before Congress',
      'offer comments at city council public meeting',
      'campaign for governor'
    ],
    answerIndex: 2,
    hint: 'Direct, accessible influence ‚Üí public comment at a meeting.',
    explain: 'Correct: offering comments at a city council public meeting is an effective influence method.'
  },
  {
    id: 'Q166_STATEWIDE_BALLOT',
    type: 'mcq',
    title: 'Statewide Action ‚Äî Ballot Issues (Released)',
    prompt:
`How can a citizen become involved in addressing problems that affect the entire state?`,
    options: [
      'By joining a community watch group',
      'By volunteering for the fire department',
      'By signing petitions to place issues on the ballot',
      'By attending a meeting of the local school board'
    ],
    answerIndex: 2,
    hint: 'Entire state ‚Üí ballot initiative/petition process.',
    explain: 'Correct: petitions to place issues on the ballot address statewide issues.'
  },
  {
    id: 'Q172_SKATEPARK_LOCAL',
    type: 'mcq',
    title: 'Local Decision ‚Äî City-Owned Land (Released)',
    prompt:
`Your city is debating whether to install a skateboard park on city-owned land. You want to support the park. Which method would be effective in helping to determine public policy on this decision?`,
    options: [
      'Participate in the governor‚Äôs re-election campaign',
      'Send an email to your U.S. senators expressing your point of view',
      'Attend the meeting of the city council and present the benefits of a park',
      'Organize a letter-writing campaign to members of the Ohio General Assembly'
    ],
    answerIndex: 2,
    hint: 'City-owned land ‚Üí city council.',
    explain: 'Correct: attending city council and presenting benefits targets the local policymakers.'
  },

  // Extra RELEASED grid that fits this game‚Äôs theme
  {
    id: 'Q19_Q142_STATE_LOCAL_OPPORTUNITIES',
    type: 'grid_single_per_row',
    title: 'Participation Opportunities ‚Äî State vs Local (Released)',
    prompt:
`Citizens of Ohio have a variety of options available to them for participation in state and local government. Select the proper box for each opportunity from the examples listed.`,
    grid: {
      columns: ['State Government', 'Local Government'],
      rows: [
        { source: 'Attend city and/or township trustee meetings', correctCol: 1 },
        { source: 'Serve in the National Guard', correctCol: 0 },
        { source: 'Organize a neighborhood watch', correctCol: 1 },
        { source: 'Vote for Governor', correctCol: 0 }
      ]
    },
    hint: 'City/township + neighborhood watch = local. National Guard + governor = state.',
    explain: 'Correct: classify each civic opportunity by the level of government most connected to it.'
  },

  // =========================
  // STANDARDS-SUPPLEMENTED (CS 1 / 17 / 19) to reach 25
  // =========================
  {
    id: 'CS1_SUPP_01',
    type: 'mcq',
    title: 'Action Plan ‚Äî Identify the Issue',
    prompt:
`A student group wants safer crosswalks near the high school. What should they do FIRST to begin a civic action plan?`,
    options: [
      'Start a protest without researching',
      'Identify the problem clearly and gather information about where/when accidents occur',
      'Skip local officials and contact the president',
      'Demand an immediate vote in Congress'
    ],
    answerIndex: 1,
    hint: 'CS1 starts with identifying and researching the issue.',
    explain: 'Correct: a strong civic plan begins by clearly identifying the issue and collecting relevant information.'
  },
  {
    id: 'CS1_SUPP_02',
    type: 'mcq',
    title: 'Public Policy Process vs Political Process',
    prompt:
`A resident wants a city to add a stop sign at a dangerous intersection. Which approach MOST directly uses the public policy process?`,
    options: [
      'Campaign for a candidate for Congress',
      'Attend a city council meeting and request the traffic study be added to the agenda',
      'Create a national political party',
      'Run for president'
    ],
    answerIndex: 1,
    hint: 'Public policy process = institutional procedures to address the issue.',
    explain: 'Correct: working through city procedures (agenda/traffic study/council) is the public policy process.'
  },
  {
    id: 'CS19_SUPP_01',
    type: 'mcq',
    title: 'Influence Through Testimony',
    prompt:
`A state committee is holding a hearing on a proposed education policy. Which action would MOST directly influence the policy decision?`,
    options: [
      'Submit testimony or speak at the committee hearing',
      'Only post about it on social media',
      'Complain to friends privately',
      'Write a letter to a mayor in another state'
    ],
    answerIndex: 0,
    hint: 'Direct influence happens during hearings/decision points.',
    explain: 'Correct: testimony at a hearing directly reaches policymakers when decisions are being made.'
  },
  {
    id: 'CS17_SUPP_01',
    type: 'mcq',
    title: 'Helping Local Government Solve Problems',
    prompt:
`A community has repeated flooding after heavy rains. Which citizen action BEST reflects helping local government address a community problem?`,
    options: [
      'Ignore the problem because it is controversial',
      'Join a neighborhood civic organization working with the city on drainage solutions',
      'Ask Congress to rewrite the U.S. Constitution',
      'Vote in another state‚Äôs election'
    ],
    answerIndex: 1,
    hint: 'CS17 emphasizes assisting state/local governments with community problems.',
    explain: 'Correct: organized community involvement working with local authorities supports problem solving.'
  },
  {
    id: 'CS19_SUPP_02',
    type: 'mcq',
    title: 'Best Target: Federal vs State vs Local',
    prompt:
`A resident wants the city to change bus routes to better serve neighborhoods. Which official or body is the BEST target?`,
    options: [
      'U.S. Supreme Court',
      'City council or local transit authority',
      'Governor of a different state',
      'President of the United States'
    ],
    answerIndex: 1,
    hint: 'Bus routes are typically managed locally.',
    explain: 'Correct: local transit authorities/city government are most connected to route decisions.'
  },
  {
    id: 'CS1_SUPP_03',
    type: 'mcq',
    title: 'Costs and Benefits',
    prompt:
`A town is choosing between building a new community center or renovating the old one. What action best matches ‚Äúweighing costs and benefits‚Äù in a civic plan?`,
    options: [
      'Only consider which option is newer',
      'Compare projected costs, long-term maintenance, and community needs for each option',
      'Choose based on a rumor',
      'Pick whichever idea has the loudest supporters'
    ],
    answerIndex: 1,
    hint: 'Costs/benefits = compare data and consequences.',
    explain: 'Correct: weighing costs/benefits requires comparing projected costs and consequences for each option.'
  },
  {
    id: 'CS19_SUPP_03',
    type: 'mcq',
    title: 'Most Effective Advocacy Tool',
    prompt:
`A student wants a school board to consider a new policy. Which is MOST effective?`,
    options: [
      'Attend the school board meeting and present a clear, evidence-based proposal during public comment',
      'Only complain on social media',
      'Contact the Secretary of State for another state',
      'File a lawsuit immediately with no attempt to engage'
    ],
    answerIndex: 0,
    hint: 'Direct participation in the relevant meeting is strongest.',
    explain: 'Correct: public comment + evidence-based proposal directly engages the decision-makers.'
  },
  {
    id: 'CS17_SUPP_02',
    type: 'mcq',
    title: 'Local Volunteering and Services',
    prompt:
`A city struggles to keep a community park clean due to staffing shortages. Which action BEST supports local government services?`,
    options: [
      'Organize a volunteer cleanup group that coordinates with the parks department',
      'Petition Congress to change foreign policy',
      'Campaign for a U.S. senator',
      'Ask the Supreme Court to create a new law'
    ],
    answerIndex: 0,
    hint: 'Local service gap ‚Üí coordinated local volunteer support.',
    explain: 'Correct: coordinated volunteer support helps local government provide services.'
  },
  {
    id: 'CS19_SUPP_04',
    type: 'mcq',
    title: 'Influence Through Elections',
    prompt:
`A citizen believes their state representative ignores community concerns. Which action is MOST connected to influencing policy through the political process?`,
    options: [
      'Campaign for a challenger in the next election',
      'Only watch the news',
      'Move to another city without contacting anyone',
      'Write to the United Nations'
    ],
    answerIndex: 0,
    hint: 'Political process = elections and gaining office.',
    explain: 'Correct: campaigning for a challenger uses elections to influence who makes policy.'
  },
  {
    id: 'CS1_SUPP_04',
    type: 'mcq',
    title: 'Choose the Correct Level of Government',
    prompt:
`A resident wants the state to change driver licensing requirements. Which action is MOST appropriate?`,
    options: [
      'Attend a city council meeting in a different town',
      'Contact state legislators or the governor about changing state law',
      'Ask a school principal to rewrite state law',
      'Petition a foreign government'
    ],
    answerIndex: 1,
    hint: 'State licensing rules ‚Üí state government.',
    explain: 'Correct: state legislators/governor are responsible for state laws and regulations.'
  },
  {
    id: 'CS19_SUPP_05',
    type: 'grid_single_per_row',
    title: 'Match the Issue to the Best Action',
    prompt:
`Select the box that shows the BEST action to influence the policy decision in each situation.`,
    grid: {
      columns: [
        'Speak at a city council meeting',
        'Write to a state representative',
        'Contact a member of Congress',
        'File a lawsuit immediately'
      ],
      rows: [
        { source: 'Your city is deciding whether to add bike lanes on city streets', correctCol: 0 },
        { source: 'Ohio is debating a statewide education funding change', correctCol: 1 },
        { source: 'A federal law is proposed about national internet privacy rules', correctCol: 2 },
        { source: 'A policy clearly violates constitutional rights and caused direct harm', correctCol: 3 }
      ]
    },
    hint: 'Pick the level that controls the issue; lawsuits are for rights violations/harm.',
    explain: 'Correct: match the action to the level and type of decision being made.'
  },
  {
    id: 'CS1_SUPP_05',
    type: 'mcq',
    title: 'Implementing the Plan',
    prompt:
`After researching and proposing solutions, what step BEST represents ‚Äúimplementing‚Äù a civic plan?`,
    options: [
      'Doing nothing after creating a plan',
      'Scheduling meetings, contacting officials, and carrying out the chosen action steps',
      'Only debating the issue forever',
      'Waiting for someone else to act'
    ],
    answerIndex: 1,
    hint: 'Implementation = carry out steps.',
    explain: 'Correct: implementation means taking the planned actions, not just planning them.'
  },
  {
    id: 'CS17_SUPP_03',
    type: 'mcq',
    title: 'Controversial Local Issue',
    prompt:
`A town is debating where to locate a new homeless shelter. Which action BEST reflects responsible citizen assistance to local government?`,
    options: [
      'Spread rumors to increase tension',
      'Attend meetings, use credible information, and propose workable solutions respectfully',
      'Refuse to listen to other perspectives',
      'Only post insults online'
    ],
    answerIndex: 1,
    hint: 'Assist by engaging constructively with evidence and solutions.',
    explain: 'Correct: constructive participation helps local officials address controversial problems.'
  },
  {
    id: 'CS19_SUPP_06',
    type: 'mcq',
    title: 'Most Effective Message',
    prompt:
`A citizen wants to persuade a city council member to support a policy. Which message is MOST likely to be effective?`,
    options: [
      'A message with threats and no facts',
      'A respectful message with specific evidence, local impacts, and a clear request',
      'A message that avoids any details',
      'A message that only uses name-calling'
    ],
    answerIndex: 1,
    hint: 'Evidence + local impact + clear request.',
    explain: 'Correct: respectful, evidence-based communication is most persuasive and useful to officials.'
  },
  {
    id: 'CS1_SUPP_06',
    type: 'mcq',
    title: 'Consequences of Solutions',
    prompt:
`Students propose banning cars near the school to improve safety. Which step BEST fits ‚Äúexamine possible consequences‚Äù?`,
    options: [
      'Assume there are no downsides',
      'Consider traffic reroutes, bus access, and impacts on nearby businesses and residents',
      'Ignore how people will get to school',
      'Only focus on one group‚Äôs opinion'
    ],
    answerIndex: 1,
    hint: 'Consequences = who is affected and how.',
    explain: 'Correct: examining consequences requires considering impacts on multiple groups and logistics.'
  },
  {
    id: 'CS19_SUPP_07',
    type: 'mcq',
    title: 'Petitions as Influence',
    prompt:
`A group wants the state government to take action on a statewide issue. Which use of a petition is MOST appropriate?`,
    options: [
      'A petition delivered to the city dog warden',
      'A petition sent to state officials or used to support a statewide ballot effort',
      'A petition posted with no signatures',
      'A petition sent to a foreign leader'
    ],
    answerIndex: 1,
    hint: 'State issue ‚Üí state officials/ballot process.',
    explain: 'Correct: petitions can influence state officials or support statewide ballot efforts.'
  },
  {
    id: 'CS17_SUPP_04',
    type: 'mcq',
    title: 'Local Emergency Preparedness',
    prompt:
`Which action BEST supports local government preparedness for emergencies?`,
    options: [
      'Volunteer with local emergency response training programs and share accurate preparedness information',
      'Only criticize local officials without offering solutions',
      'Ignore emergency alerts',
      'Wait for federal officials to handle local emergencies'
    ],
    answerIndex: 0,
    hint: 'Local preparedness improves with trained volunteers and accurate information.',
    explain: 'Correct: trained volunteer support and community preparedness help local authorities respond effectively.'
  }
];


  // ---------- DOM ----------
  const elQpos = document.getElementById('qpos');
  const elAcc = document.getElementById('acc');
  const elRuntime = document.getElementById('runtime');

  const elNameBox = document.getElementById('nameBox');
  const elStudentName = document.getElementById('studentName');
  const btnStart = document.getElementById('btnStart');
  const btnResetAll = document.getElementById('btnResetAll');

  const elQuestionBox = document.getElementById('questionBox');
  const elMcqBox = document.getElementById('mcqBox');
  const elGridBox = document.getElementById('gridBox');

  const elQtitle = document.getElementById('qtitle');
  const elQtext = document.getElementById('qtext');
  const elOpts = document.getElementById('opts');

  const elGridPrompt = document.getElementById('gridPrompt');
  const elGridQ = document.getElementById('gridQ');
  const btnSubmitGrid = document.getElementById('btnSubmitGrid');

  const elFeedback = document.getElementById('feedback');
  const elFbTitle = document.getElementById('fbTitle');
  const elFbBody = document.getElementById('fbBody');
  const btnHint = document.getElementById('btnHint');
  const btnNext = document.getElementById('btnNext');

  const elFinishBox = document.getElementById('finishBox');
  const elFinishTitle = document.getElementById('finishTitle');
  const elFinishBody = document.getElementById('finishBody');
  const elTicket = document.getElementById('ticket');

  const elTName = document.getElementById('tName');
  const elTDate = document.getElementById('tDate');
  const elTStart = document.getElementById('tStart');
  const elTEnd = document.getElementById('tEnd');
  const elTRun = document.getElementById('tRun');
  const elTAcc = document.getElementById('tAcc');
  const elTCode = document.getElementById('tCode');
  const btnCopy = document.getElementById('btnCopy');
  const btnReset = document.getElementById('btnReset');

  // ---------- Persistence ----------
  function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
  function load(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return false;
      const parsed = JSON.parse(raw);
      if(!parsed || !parsed.startedAtISO || !parsed.name) return false;
      state = parsed;
      return true;
    }catch{ return false; }
  }
  function clearSave(){ localStorage.removeItem(STORAGE_KEY); }

  // ---------- Stats ----------
  function updateStats(){
    const total = QUESTIONS.length;
    const pos = Math.min(state.idx+1, total);
    elQpos.textContent = `${pos} / ${total}`;

    const acc = state.attempts ? Math.round((state.correct/state.attempts)*100) : 0;
    elAcc.textContent = `${acc}%`;

    const rt = state.startedAtMS ? (Date.now() - state.startedAtMS) : 0;
    elRuntime.textContent = msToHMS(rt);
  }
  setInterval(() => updateStats(), 500);

  // ---------- UI helpers ----------
  function setFeedback(kind, title, body){
    elFeedback.className = `msg ${kind}`;
    elFbTitle.textContent = title;
    elFbBody.textContent = body;
  }
  function clearFeedback(){
    elFeedback.className = 'msg';
    elFbTitle.textContent = '';
    elFbBody.textContent = '';
    elFeedback.style.display = 'none';
    elFeedback.style.display = '';
  }

  function disableInputs(disabled){
    document.querySelectorAll('.optbtn').forEach(b => b.disabled = disabled);
    elGridQ.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.disabled = disabled);
    btnSubmitGrid.disabled = disabled;
  }

  function showQuestion(){
    const q = QUESTIONS[state.idx];
    clearFeedback();

    btnNext.disabled = true;
    btnHint.disabled = true;

    elQtitle.textContent = q.title;
    elQtext.textContent = q.prompt;

    elMcqBox.style.display = 'none';
    elGridBox.style.display = 'none';

    if(q.type === 'mcq'){
      elMcqBox.style.display = '';
      elOpts.innerHTML = '';
      const letters = ['A','B','C','D','E','F','G','H'];
      q.options.forEach((text, i) => {
        const b = document.createElement('button');
        b.className = 'optbtn';
        b.innerHTML = `<span class="ltr">${letters[i]}.</span>${escapeHtml(text)}`;
        b.addEventListener('click', () => answerMCQ(i));
        elOpts.appendChild(b);
      });
    }

    if(q.type === 'grid_single_per_row'){
      elGridBox.style.display = '';
      elGridPrompt.textContent = q.prompt;

      const cols = q.grid.columns;
      const rows = q.grid.rows;

      // Grid template (1 prompt col + N choice cols)
      elGridQ.innerHTML = '';

      const hdr = document.createElement('div');
      hdr.className = 'hdr';
      hdr.style.gridTemplateColumns = `${Math.max(280, Math.min(520, 0))}px repeat(${cols.length}, 1fr)`;
      hdr.innerHTML = `<div class="cell"></div>` + cols.map(c=>`<div class="cell">${escapeHtml(c)}</div>`).join('');
      elGridQ.appendChild(hdr);

      rows.forEach((r, rowIdx) => {
        const row = document.createElement('div');
        row.className = 'r';
        row.style.gridTemplateColumns = `1.6fr repeat(${cols.length}, 1fr)`;

        const src = document.createElement('div');
        src.className = 'cell src';
        src.textContent = r.source;
        row.appendChild(src);

        cols.forEach((c, colIdx) => {
          const cell = document.createElement('div');
          cell.className = 'cell';
          const id = `g_${rowIdx}_${colIdx}`;
          cell.innerHTML = `
            <label>
              <input type="checkbox" id="${id}" data-row="${rowIdx}" data-col="${colIdx}">
              <span class="mono">${String.fromCharCode(65+colIdx)}</span>
            </label>
          `;
          row.appendChild(cell);
        });

        elGridQ.appendChild(row);
      });

      // one check per row
      elGridQ.querySelectorAll('input[type="checkbox"]').forEach(cb=>{
        cb.addEventListener('change', () => {
          if(!cb.checked) return;
          const row = cb.dataset.row;
          elGridQ.querySelectorAll(`input[data-row="${row}"]`).forEach(other=>{
            if(other !== cb) other.checked = false;
          });
        });
      });
    }

    updateStats();
    save();
  }

  // ---------- Answering ----------
  function answerMCQ(choiceIdx){
    const q = QUESTIONS[state.idx];
    state.attempts += 1;

    const correct = (choiceIdx === q.answerIndex);
    if(correct){
      state.correct += 1;
      setFeedback('good', 'Correct ‚úÖ', q.explain);
      disableInputs(true);
      btnNext.disabled = false;
      btnHint.disabled = true;
      save();
    } else {
      state.missed += 1;
      setFeedback('bad', 'Not yet ‚ùå', 'Try again. Click ‚ÄúHint‚Äù if you need help.');
      btnHint.disabled = false;
      btnNext.disabled = true;
      save();
    }
    updateStats();
  }

  btnHint.addEventListener('click', () => {
    const q = QUESTIONS[state.idx];
    setFeedback('warn', 'Hint üí°', q.hint);
    btnHint.disabled = true;
  });

  btnNext.addEventListener('click', () => {
    state.idx += 1;
    if(state.idx >= QUESTIONS.length){
      showFinish();
      return;
    }
    disableInputs(false);
    showQuestion();
  });

  btnSubmitGrid.addEventListener('click', () => {
    const q = QUESTIONS[state.idx];
    state.attempts += 1;

    const rows = q.grid.rows;
    const selections = rows.map((r, rowIdx) => {
      const checked = elGridQ.querySelector(`input[data-row="${rowIdx}"]:checked`);
      return checked ? Number(checked.dataset.col) : -1;
    });

    const allSelected = selections.every(v => v !== -1);
    const allCorrect = allSelected && selections.every((v, rowIdx) => v === rows[rowIdx].correctCol);

    if(allCorrect){
      state.correct += 1;
      setFeedback('good', 'Correct ‚úÖ', q.explain);
      disableInputs(true);
      btnNext.disabled = false;
      btnHint.disabled = true;
      save();
    } else {
      state.missed += 1;
      if(!allSelected){
        setFeedback('bad', 'Not yet ‚ùå', 'Make a selection in every row, then submit again. You can use ‚ÄúHint.‚Äù');
      } else {
        setFeedback('bad', 'Not yet ‚ùå', 'Some rows are incorrect. Use ‚ÄúHint,‚Äù adjust, and submit again.');
      }
      btnHint.disabled = false;
      btnNext.disabled = true;
      save();
    }
    updateStats();
  });

  // ---------- Finish / Ticket ----------
  function showFinish(){
    elNameBox.style.display = 'none';
    elQuestionBox.style.display = 'none';
    elFinishBox.style.display = '';

    const acc = state.attempts ? Math.round((state.correct/state.attempts)*100) : 0;
    const ended = now();

    if(acc === 100 && state.attempts >= QUESTIONS.length){
      elFinishTitle.textContent = 'Mastery achieved ‚úÖ';
      elFinishBody.textContent = 'You finished with 100% accuracy. Screenshot the ticket (no cropping).';

      const start = new Date(state.startedAtISO);
      const runMS = Date.now() - state.startedAtMS;

      elTName.textContent = state.name;
      elTDate.textContent = fmtDate(ended);
      elTStart.textContent = fmtTime(start);
      elTEnd.textContent = fmtTime(ended);
      elTRun.textContent = msToHMS(runMS);
      elTAcc.textContent = `${acc}%`;

      const raw = `${state.name}|${state.startedAtISO}|${ended.toISOString()}|${state.correct}|${state.attempts}|${QUESTIONS.length}`;
      const code = `GOV-CIVIC-${base36(hash32(raw))}-${base36(hash32(raw+'X')).slice(0,4)}`;
      elTCode.textContent = code;

      elTicket.style.display = '';
      clearSave();
    } else {
      elFinishTitle.textContent = 'Mastery NOT achieved ‚ùå';
      elFinishBody.textContent = `Accuracy: ${acc}%. You must replay for 100% (0 misses). Click ‚ÄúPlay Again.‚Äù`;
      elTicket.style.display = 'none';
    }

    updateStats();
  }

  btnCopy.addEventListener('click', async () => {
    try{
      await navigator.clipboard.writeText(elTCode.textContent.trim());
      btnCopy.textContent = 'Copied ‚úÖ';
      setTimeout(()=>btnCopy.textContent='Copy Ticket Code', 1100);
    }catch{
      btnCopy.textContent = 'Copy failed';
      setTimeout(()=>btnCopy.textContent='Copy Ticket Code', 1100);
    }
  });

  btnReset.addEventListener('click', () => {
    clearSave();
    location.reload();
  });

  btnResetAll.addEventListener('click', () => {
    clearSave();
    location.reload();
  });

  // ---------- Start ----------
  btnStart.addEventListener('click', () => {
    const name = (elStudentName.value || '').trim();
    if(name.length < 2){
      setFeedback('bad', 'Name required', 'Enter your name to begin.');
      elFeedback.style.display = 'block';
      return;
    }
    state.name = name;
    const start = now();
    state.startedAtISO = start.toISOString();
    state.startedAtMS = Date.now();
    state.idx = 0;
    state.attempts = 0;
    state.correct = 0;
    state.missed = 0;
    save();

    elNameBox.style.display = 'none';
    elQuestionBox.style.display = '';
    showQuestion();
  });

  if(load()){
    elStudentName.value = state.name || '';
    elNameBox.style.display = 'none';
    elQuestionBox.style.display = '';
    showQuestion();
  }

  function escapeHtml(s){
    return String(s)
      .replaceAll('&','&amp;')
      .replaceAll('<','&lt;')
      .replaceAll('>','&gt;')
      .replaceAll('"','&quot;')
      .replaceAll("'","&#039;");
  }
})();
</script>
</body>
</html>
